<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitki Detayı - EcoSifaa</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#28a745">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="EcoSifaa">
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <style>
        .navbar {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .plant-image {
            max-height: 400px;
            object-fit: cover;
        }
        .feature-icon {
            width: 4rem;
            height: 4rem;
            border-radius: 0.75rem;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }
        .benefit-badge {
            font-size: 0.9rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0.75rem;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">EcoSifaa</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Ana Sayfa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="bitkiler.html">Şifalı Bitkiler</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#hastaliklar">Rahatsızlıklar</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#hakkimizda">Hakkımızda</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Bitki Detay İçeriği -->
    <main class="container py-5">
        <!-- Geri Butonu -->
        <div class="mb-4">
            <a href="index.html" class="btn btn-outline-success">
                <i class="bi bi-arrow-left me-2"></i> Ana Sayfaya Dön
            </a>
        </div>

        <div id="loading" class="text-center py-5">
            <div class="spinner-border text-success" role="status">
                <span class="visually-hidden">Yükleniyor...</span>
            </div>
            <p class="mt-3">Bitki detayları yükleniyor...</p>
        </div>

        <div id="error-container" class="alert alert-danger d-none" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <span id="error-message">Bitki bilgileri yüklenirken bir hata oluştu.</span>
        </div>

        <div id="plant-details" class="d-none">
            <!-- Bitki Başlık Bilgileri -->
            <div class="row mb-5">
                <div class="col-md-5 mb-4 mb-md-0">
                    <div class="card border-0 shadow h-100">
                        <img id="plant-image" src="" alt="" class="card-img-top plant-image img-fluid">
                    </div>
                </div>
                <div class="col-md-7">
                    <h1 id="plant-name" class="mb-2"></h1>
                    <p id="plant-scientific-name" class="text-muted fst-italic mb-3"></p>
                    
                    <div class="mb-4">
                        <span id="plant-type" class="badge bg-success me-2"></span>
                        <span id="plant-region" class="badge bg-info text-dark me-2 d-none">
                            <i class="bi bi-geo-alt me-1"></i>
                            <span></span>
                        </span>
                    </div>
                    
                    <div class="card border-0 bg-light mb-4">
                        <div class="card-body">
                            <h5 class="card-title">Genel Bilgi</h5>
                            <p id="plant-description" class="card-text"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detay Bilgileri -->
            <div class="row">
                <!-- Özellikler -->
                <div class="col-lg-6 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-header bg-success bg-opacity-10 border-0">
                            <h4 class="mb-0 text-success">
                                <i class="bi bi-flower1 me-2"></i>Özellikleri
                            </h4>
                        </div>
                        <div class="card-body">
                            <ul class="list-group list-group-flush" id="plant-properties">
                                <!-- Özellikler buraya JavaScript ile eklenecek -->
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Faydaları -->
                <div class="col-lg-6 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-header bg-success bg-opacity-10 border-0">
                            <h4 class="mb-0 text-success">
                                <i class="bi bi-heart-pulse me-2"></i>Faydaları
                            </h4>
                        </div>
                        <div class="card-body">
                            <div id="plant-benefits">
                                <!-- Faydalar buraya JavaScript ile eklenecek -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kullanım Şekilleri -->
                <div class="col-12 mb-4">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-success bg-opacity-10 border-0">
                            <h4 class="mb-0 text-success">
                                <i class="bi bi-journal-medical me-2"></i>Kullanım Şekilleri
                            </h4>
                        </div>
                        <div class="card-body">
                            <div id="plant-usage">
                                <!-- Kullanım şekilleri buraya JavaScript ile eklenecek -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Uyarılar (Eğer varsa) -->
                <div id="warnings-container" class="col-12 mb-4 d-none">
                    <div class="card border-0 shadow-sm border-warning">
                        <div class="card-header bg-warning bg-opacity-10 border-0">
                            <h4 class="mb-0 text-warning">
                                <i class="bi bi-exclamation-triangle me-2"></i>Uyarılar
                            </h4>
                        </div>
                        <div class="card-body">
                            <p id="plant-warnings" class="card-text"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>EcoSifaa</h5>
                    <p class="small mb-2">Şifalı Bitkiler Veritabanı</p>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-white"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-twitter"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-instagram"></i></a>
                    </div>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small mb-2">İletişim: info@ecosifaa.com</p>
                    <p class="small">&copy; 2023 EcoSifaa. Tüm hakları saklıdır.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // API URL
        const API_BASE_URL = 'http://localhost:8000/api';
        
        // DOM yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            // URL'den bitki ID'sini al
            const urlParams = new URLSearchParams(window.location.search);
            const plantId = urlParams.get('id');
            
            if (!plantId) {
                showError('Bitki ID bulunamadı. Ana sayfaya yönlendiriliyorsunuz.');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 3000);
                return;
            }
            
            // Bitki detaylarını getir
            fetchPlantDetails(plantId);
        });
        
        // Bitki detaylarını getir
        async function fetchPlantDetails(id) {
            try {
                const response = await fetch(`${API_BASE_URL}/bitkiler/${id}/`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const plant = await response.json();
                displayPlantDetails(plant);
            } catch (error) {
                console.error('Bitki detayları yüklenirken hata oluştu:', error);
                showError('Bitki detayları yüklenirken bir hata oluştu. Lütfen daha sonra tekrar deneyin.');
                // Örnek veri ile göster
                displaySamplePlantDetails(id);
            }
        }
        
        // Hata göster
        function showError(message) {
            document.getElementById('loading').classList.add('d-none');
            
            const errorContainer = document.getElementById('error-container');
            const errorMessage = document.getElementById('error-message');
            
            errorMessage.textContent = message;
            errorContainer.classList.remove('d-none');
        }
        
        // Bitki detaylarını görüntüle
        function displayPlantDetails(plant) {
            // Yükleniyor göstergesini gizle
            document.getElementById('loading').classList.add('d-none');
            
            // Bitki detaylarını göster
            document.getElementById('plant-details').classList.remove('d-none');
            
            // Temel bilgileri doldur
            document.getElementById('plant-name').textContent = plant.isim;
            document.title = `${plant.isim} - EcoSifaa`;
            
            // Resim
            const plantImage = document.getElementById('plant-image');
            plantImage.src = plant.resim || 'https://via.placeholder.com/400x300?text=Resim+Yok';
            plantImage.alt = plant.isim;
            plantImage.onerror = function() {
                this.src = 'https://via.placeholder.com/400x300?text=Resim+Yok';
            };
            
            // Bilimsel Ad
            const scientificName = document.getElementById('plant-scientific-name');
            if (plant.bilimsel_ad) {
                scientificName.textContent = plant.bilimsel_ad;
            } else {
                scientificName.classList.add('d-none');
            }
            
            // Tip
            document.getElementById('plant-type').textContent = plant.tip;
            
            // Bölge
            const regionBadge = document.getElementById('plant-region');
            if (plant.yetistigi_bolge) {
                regionBadge.querySelector('span').textContent = plant.yetistigi_bolge;
                regionBadge.classList.remove('d-none');
            }
            
            // Açıklama
            document.getElementById('plant-description').textContent = plant.faydalar || 'Açıklama bulunmamaktadır.';
            
            // Özellikler
            const propertiesList = document.getElementById('plant-properties');
            propertiesList.innerHTML = '';
            
            // Yetiştiği Yerler
            if (plant.yetistigi_yerler) {
                addPropertyItem(propertiesList, 'Yetiştiği Yerler', plant.yetistigi_yerler);
            }
            
            // Hasat Zamanı
            if (plant.hasat_zamani) {
                addPropertyItem(propertiesList, 'Hasat Zamanı', plant.hasat_zamani);
            }
            
            // Aktif Bileşenler
            if (plant.aktif_bilesenler) {
                addPropertyItem(propertiesList, 'Aktif Bileşenler', plant.aktif_bilesenler);
            }
            
            // Saklama Koşulları
            if (plant.saklama_kosullari) {
                addPropertyItem(propertiesList, 'Saklama Koşulları', plant.saklama_kosullari);
            }
            
            // Raf Ömrü
            if (plant.raf_omru) {
                addPropertyItem(propertiesList, 'Raf Ömrü', plant.raf_omru);
            }
            
            // Eğer hiç özellik eklenmemişse
            if (propertiesList.children.length === 0) {
                propertiesList.innerHTML = '<p class="text-muted">Özellik bilgisi bulunmamaktadır.</p>';
            }
            
            // Faydalar
            const benefitsContainer = document.getElementById('plant-benefits');
            
            if (plant.faydalar) {
                const faydalarArray = plant.faydalar.split('.').filter(item => item.trim() !== '');
                
                if (faydalarArray.length > 0) {
                    const ul = document.createElement('ul');
                    ul.className = 'list-group list-group-flush';
                    
                    faydalarArray.forEach(fayda => {
                        const li = document.createElement('li');
                        li.className = 'list-group-item border-0 ps-0';
                        li.innerHTML = `<i class="bi bi-check-circle-fill text-success me-2"></i>${fayda.trim()}.`;
                        ul.appendChild(li);
                    });
                    
                    benefitsContainer.appendChild(ul);
                } else {
                    benefitsContainer.innerHTML = '<p class="text-muted">Fayda bilgisi bulunmamaktadır.</p>';
                }
            } else {
                benefitsContainer.innerHTML = '<p class="text-muted">Fayda bilgisi bulunmamaktadır.</p>';
            }
            
            // Kullanım
            const usageContainer = document.getElementById('plant-usage');
            
            if (plant.kullanim) {
                usageContainer.innerHTML = plant.kullanim;
            } else if (plant.hazirlama) {
                usageContainer.innerHTML = plant.hazirlama;
            } else {
                usageContainer.innerHTML = '<p class="text-muted">Kullanım şekli bilgisi bulunmamaktadır.</p>';
            }
            
            // Uyarılar
            const warningsContainer = document.getElementById('warnings-container');
            
            if (plant.uyarilar) {
                document.getElementById('plant-warnings').textContent = plant.uyarilar;
                warningsContainer.classList.remove('d-none');
            }
        }
        
        // Özellik öğesi ekle
        function addPropertyItem(container, label, value) {
            const item = document.createElement('li');
            item.className = 'list-group-item d-flex border-0 ps-0';
            
            const labelSpan = document.createElement('span');
            labelSpan.className = 'fw-bold me-2 text-secondary';
            labelSpan.textContent = `${label}:`;
            
            const valueSpan = document.createElement('span');
            valueSpan.textContent = value;
            
            item.appendChild(labelSpan);
            item.appendChild(valueSpan);
            
            container.appendChild(item);
        }
        
        // Örnek bitki verisiyle göster (API çalışmadığında)
        function displaySamplePlantDetails(id) {
            const samplePlants = {
                '1': {
                    isim: 'Lavanta',
                    bilimsel_ad: 'Lavandula angustifolia',
                    tip: 'Çiçek',
                    faydalar: 'Lavanta, rahatlatıcı etkisi ile bilinen aromatik bir bitkidir. Stres ve anksiyete seviyelerini düşürmeye yardımcı olur. Uyku kalitesini artırır ve uykusuzluk sorunlarına iyi gelir. Antiseptik özelliklere sahiptir. Baş ağrısı ve migreni hafifletebilir.',
                    kullanim: '<p>Lavanta çayı: 1-2 tatlı kaşığı kurutulmuş lavanta çiçeği 1 bardak sıcak suya eklenir ve 5-10 dakika demlenir.</p><p>Lavanta yağı: Aromaterapide kullanılabilir veya seyreltilerek cilde masaj yoluyla uygulanabilir.</p><p>Lavanta kesesi: Kurutulmuş lavanta çiçekleri bez keselere doldurularak dolap ve çekmecelere yerleştirilebilir.</p>',
                    yetistigi_yerler: 'Akdeniz bölgesi, Kuzey Afrika, Avrupa',
                    hasat_zamani: 'Haziran - Ağustos ayları arası',
                    aktif_bilesenler: 'Linalool, linalil asetat, terpinen-4-ol, lavandulil asetat',
                    uyarilar: 'Hamileler, emzirenler ve küçük çocuklarda kullanmadan önce doktora danışılmalıdır. Bazı kişilerde alerjik reaksiyonlara neden olabilir.',
                    resim: 'https://images.unsplash.com/photo-1546387903-6d82d96ccca6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1471&q=80'
                },
                '2': {
                    isim: 'Nane',
                    bilimsel_ad: 'Mentha piperita',
                    tip: 'Yaprak',
                    faydalar: 'Nane, sindirim sistemini rahatlatıcı etkisi ile bilinir. Mide bulantısı ve kusma hislerini azaltır. Hazımsızlık, şişkinlik ve bağırsak gazı gibi sindirim sorunlarını hafifletir. Baş ağrılarını ve migreni hafifletmeye yardımcı olabilir. Boğaz ağrısı ve öksürük için rahatlatıcıdır.',
                    kullanim: '<p>Nane çayı: 5-10 taze nane yaprağı veya 1-2 tatlı kaşığı kurutulmuş nane 1 bardak sıcak suya eklenir ve 5-10 dakika demlenir.</p><p>Nane yağı: Seyreltilerek masaj yoluyla cilde uygulanabilir veya buhar inhalasyonu için kullanılabilir.</p><p>Taze nane: Salaталara, içeceklere veya tatlılara eklenebilir.</p>',
                    yetistigi_yerler: 'Avrupa, Asya, Kuzey Amerika',
                    hasat_zamani: 'Mayıs - Eylül ayları arası',
                    aktif_bilesenler: 'Mentol, menton, mentil asetat, limonene',
                    uyarilar: 'Nane yağı bebeklerde ve küçük çocuklarda kullanılmamalıdır. Reflü veya safra kesesi rahatsızlığı olan kişiler kullanmadan önce doktora danışmalıdır.',
                    resim: 'https://images.unsplash.com/photo-1593484812012-3e2fe2a61f76?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80'
                },
                '3': {
                    isim: 'Adaçayı',
                    bilimsel_ad: 'Salvia officinalis',
                    tip: 'Ot',
                    faydalar: 'Adaçayı, antiseptik ve iltihap giderici özelliklere sahiptir. Boğaz ağrısı, diş eti iltihabı ve ağız yaralarını rahatlatır. Sindirim sorunlarında yardımcı olur. Ateş düşürmeye yardımcı olabilir. Aşırı terlemeyi azaltabilir.',
                    kullanim: '<p>Adaçayı çayı: 1-2 tatlı kaşığı kurutulmuş adaçayı yaprağı 1 bardak sıcak suya eklenir ve 5-10 dakika demlenir.</p><p>Adaçayı gargara: Boğaz ağrısı ve ağız yaraları için adaçayı çayı ile gargara yapılabilir.</p><p>Kurutulmuş adaçayı: Yemeklere baharat olarak eklenebilir.</p>',
                    yetistigi_yerler: 'Akdeniz bölgesi, Güney Avrupa',
                    hasat_zamani: 'Haziran - Ağustos ayları arası',
                    aktif_bilesenler: 'Thujon, cineol, borneol, salviol',
                    uyarilar: 'Hamileler, emzirenler, epilepsi hastaları ve sara nöbeti geçirenler kullanmamalıdır. Uzun süreli kullanımdan kaçınılmalıdır.',
                    resim: 'https://images.unsplash.com/photo-1590421958459-071ca4271af6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80'
                }
            };
            
            // ID'ye göre örnek bitki verisi bul
            const plant = samplePlants[id];
            
            if (plant) {
                displayPlantDetails(plant);
            } else {
                showError('Bitki bulunamadı. Ana sayfaya yönlendiriliyorsunuz.');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 3000);
            }
        }

        // Service Worker kaydı
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('Service Worker başarıyla kaydedildi', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker kaydedilemedi:', error);
                    });
            });
        }
    </script>
</body>
</html> 